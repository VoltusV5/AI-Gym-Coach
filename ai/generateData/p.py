import random
import json
from typing import Dict, List, Any

# ========== –ë–ê–ó–ê –ó–ù–ê–ù–ò–ô ==========

EXERCISES = {
    "–≥—Ä—É–¥—å": {
        "–±–∞–∑–æ–≤—ã–µ": [
            {"name": "–∂–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π", "–∂–∏–º –≤ –°–º–∏—Ç–µ"]},
            {"name": "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–∂–∏–º —à—Ç–∞–Ω–≥–∏", "–∂–∏–º –ø–æ–¥ —É–≥–ª–æ–º"]},
            {"name": "–æ—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–∂–∏–º –∫–Ω–∏–∑—É", "–æ—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç —Å–∫–∞–º—å–∏"]}
        ],
        "–∏–∑–æ–ª–∏—Ä—É—é—â–∏–µ": [
            {"name": "—Ä–∞–∑–≤–æ–¥–∫–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–∫—Ä–æ—Å—Å–æ–≤–µ—Ä", "—Ä–∞–∑–≤–æ–¥–∫–∞ –≤ –Ω–∞–∫–ª–æ–Ω–µ"]},
            {"name": "–∫—Ä–æ—Å—Å–æ–≤–µ—Ä", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Ä–∞–∑–≤–æ–¥–∫–∞ –≥–∞–Ω—Ç–µ–ª–µ–π", "—Å–≤–µ–¥–µ–Ω–∏–µ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ"]}
        ]
    },
    "—Å–ø–∏–Ω–∞": {
        "–±–∞–∑–æ–≤—ã–µ": [
            {"name": "–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞", "–∞–≤—Å—Ç—Ä–∞–ª–∏–π—Å–∫–∏–µ"]},
            {"name": "—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Ç—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏", "–¢-—Ç—è–≥–∞"]},
            {"name": "—Ç—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –∫ –ø–æ—è—Å—É", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏", "—Ç—è–≥–∞ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ"]}
        ],
        "–∏–∑–æ–ª–∏—Ä—É—é—â–∏–µ": [
            {"name": "—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è", "–ø—É–ª–ª–æ–≤–µ—Ä"]},
            {"name": "–ø—É–ª–ª–æ–≤–µ—Ä", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Ç—è–≥–∞ –±–ª–æ–∫–∞", "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è"]}
        ]
    },
    "–Ω–æ–≥–∏": {
        "–±–∞–∑–æ–≤—ã–µ": [
            {"name": "–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–µ", "–≥–æ–±–ª–µ—Ç"]},
            {"name": "–∂–∏–º –Ω–æ–≥–∞–º–∏", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è", "–≥–∞–∫–∫-–ø—Ä–∏—Å–µ–¥"]},
            {"name": "—Ä—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–º–µ—Ä—Ç–≤–∞—è —Ç—è–≥–∞", "–Ω–∞ –ø—Ä—è–º—ã—Ö –Ω–æ–≥–∞—Ö"]}
        ],
        "–∏–∑–æ–ª–∏—Ä—É—é—â–∏–µ": [
            {"name": "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è", "–≤—ã–ø–∞–¥—ã"]},
            {"name": "—Å–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Ä—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞", "–º–µ—Ä—Ç–≤–∞—è"]},
            {"name": "–≤—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–≤—ã–ø–∞–¥—ã –Ω–∞–∑–∞–¥", "–±–æ–ª–≥–∞—Ä—Å–∫–∏–µ"]}
        ]
    },
    "–ø–ª–µ—á–∏": {
        "–±–∞–∑–æ–≤—ã–µ": [
            {"name": "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–∞—Ä–º–µ–π—Å–∫–∏–π –∂–∏–º", "–∂–∏–º —à—Ç–∞–Ω–≥–∏"]},
            {"name": "–∞—Ä–º–µ–π—Å–∫–∏–π –∂–∏–º", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π", "–∂–∏–º –≤ –°–º–∏—Ç–µ"]}
        ],
        "–∏–∑–æ–ª–∏—Ä—É—é—â–∏–µ": [
            {"name": "–º–∞—Ö–∏ –≥–∞–Ω—Ç–µ–ª—è–º–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–∫—Ä–æ—Å—Å–æ–≤–µ—Ä", "–∑–∞–¥–Ω—è—è –¥–µ–ª—å—Ç–∞"]},
            {"name": "–º–∞—Ö–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–æ–±—Ä–∞—Ç–Ω—ã–µ —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è", "–∫—Ä–æ—Å—Å–æ–≤–µ—Ä"]},
            {"name": "–ø–æ–¥—ä—ë–º—ã –≥–∞–Ω—Ç–µ–ª–µ–π –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–±–ª–∏–Ω", "–∫—Ä–æ—Å—Å–æ–≤–µ—Ä"]}
        ]
    },
    "–±–∏—Ü–µ–ø—Å": {
        "–∏–∑–æ–ª–∏—Ä—É—é—â–∏–µ": [
            {"name": "—Å–≥–∏–±–∞–Ω–∏—è —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–º–æ–ª–æ—Ç", "–Ω–∏–∂–Ω–∏–π –±–ª–æ–∫"]},
            {"name": "–º–æ–ª–æ—Ç–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Å–≥–∏–±–∞–Ω–∏—è –≥–∞–Ω—Ç–µ–ª–µ–π", "–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ"]},
            {"name": "—Å–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Å–∫–∞–º—å–µ –°–∫–æ—Ç—Ç–∞", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Å—Ç–æ—è", "–±–ª–æ–∫"]}
        ]
    },
    "—Ç—Ä–∏—Ü–µ–ø—Å": {
        "–∏–∑–æ–ª–∏—Ä—É—é—â–∏–µ": [
            {"name": "—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –±–ª–æ–∫–∞", "–∫–∏–∫–±–µ–∫"]},
            {"name": "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π", "–æ–±—Ä–∞—Ç–Ω—ã–µ –æ—Ç–∂–∏–º–∞–Ω–∏—è"]}
        ]
    },
    "–ø—Ä–µ—Å—Å": {
        "–∏–∑–æ–ª–∏—Ä—É—é—â–∏–µ": [
            {"name": "—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–∫—Ä–∞–Ω—á–∏", "—Å —Ä–æ–ª–∏–∫–æ–º"]},
            {"name": "–ø–æ–¥—ä—ë–º—ã –Ω–æ–≥", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–≤–∏—Å", "–æ–±—Ä–∞—Ç–Ω—ã–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è"]},
            {"name": "–ø–ª–∞–Ω–∫–∞", "–≤–∞—Ä–∏–∞—Ü–∏–∏": ["–±–æ–∫–æ–≤–∞—è", "–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è"]}
        ]
    }
}

# –°–ø–ª–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–Ω–µ–π
SPLITS_BY_DAYS = {
    2: {
        "–î–µ–Ω—å 1": ["–≥—Ä—É–¥—å", "—Ç—Ä–∏—Ü–µ–ø—Å"],
        "–î–µ–Ω—å 2": ["—Å–ø–∏–Ω–∞", "–±–∏—Ü–µ–ø—Å"]
    },
    3: {
        "–î–µ–Ω—å 1": ["–≥—Ä—É–¥—å", "—Ç—Ä–∏—Ü–µ–ø—Å"],
        "–î–µ–Ω—å 2": ["—Å–ø–∏–Ω–∞", "–±–∏—Ü–µ–ø—Å"],
        "–î–µ–Ω—å 3": ["–Ω–æ–≥–∏"]
    },
    4: {
        "–î–µ–Ω—å 1": ["–≥—Ä—É–¥—å", "—Ç—Ä–∏—Ü–µ–ø—Å"],
        "–î–µ–Ω—å 2": ["—Å–ø–∏–Ω–∞", "–±–∏—Ü–µ–ø—Å"],
        "–î–µ–Ω—å 3": ["–Ω–æ–≥–∏"],
        "–î–µ–Ω—å 4": ["–ø–ª–µ—á–∏", "–ø—Ä–µ—Å—Å"]
    }
}


VALID_VARIATIONS = {
    "–∂–∏–º": ["–∂–∏–º"],
    "—Ç—è–≥–∞": ["—Ç—è–≥–∞", "–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è"],
    "–ø—Ä–∏—Å–µ–¥": ["–ø—Ä–∏—Å–µ–¥", "–∂–∏–º –Ω–æ–≥–∞–º–∏", "–≤—ã–ø–∞–¥—ã"],
    "—Ä–∞–∑–≤–æ–¥–∫–∞": ["—Ä–∞–∑–≤–æ–¥–∫–∞", "–∫—Ä–æ—Å—Å–æ–≤–µ—Ä"],
    "—Å–≥–∏–±–∞–Ω–∏—è": ["—Å–≥–∏–±–∞–Ω–∏—è", "–º–æ–ª–æ—Ç"],
    "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è": ["—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è", "—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π"],
    "–ø—Ä–µ—Å—Å": ["—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è", "–ø–ª–∞–Ω–∫–∞"]
}

MOVEMENT_MAP = {
    "–∂–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞": "horizontal_push",
    "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞": "horizontal_push",
    "–æ—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö": "vertical_push",
    "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è": "vertical_push",
    "–∞—Ä–º–µ–π—Å–∫–∏–π –∂–∏–º": "vertical_push",
    "–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è": "vertical_pull",
    "—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞": "vertical_pull",
    "—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ": "horizontal_pull",
    "—Ç—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –∫ –ø–æ—è—Å—É": "horizontal_pull",
    "–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π": "knee_dominant",
    "–∂–∏–º –Ω–æ–≥–∞–º–∏": "knee_dominant",
    "—Ä—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞": "hip_dominant",
    "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥": "knee_isolation",
    "—Å–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥": "hip_isolation",
    "–ø–ª–∞–Ω–∫–∞": "core",
    "—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è": "core",
}

EXERCISE_ROLE = {
    "–∂–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞": "base",
    "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞": "secondary",
    "—Ä–∞–∑–≤–æ–¥–∫–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞": "isolation",
    "–∫—Ä–æ—Å—Å–æ–≤–µ—Ä": "isolation",
    "–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è": "base",
    "—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ": "secondary",
    "—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞": "isolation",
    "–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π": "base",
    "–∂–∏–º –Ω–æ–≥–∞–º–∏": "secondary",
    "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥": "isolation",
    "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è": "base",
    "–º–∞—Ö–∏ –≥–∞–Ω—Ç–µ–ª—è–º–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã": "isolation",
    "—Å–≥–∏–±–∞–Ω–∏—è —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è": "secondary",
    "–º–æ–ª–æ—Ç–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏": "secondary",
    "—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º": "secondary",
    "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ": "isolation",
    "—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è": "secondary",
    "–ø–ª–∞–Ω–∫–∞": "isolation"
}

# –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞, –ø–æ—Å–ª–µ EXERCISES
INITIAL_WEIGHTS_KG = {
    "–º": {  # –º—É–∂—á–∏–Ω—ã
        "–∂–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞":          50,
        "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞":        16,   # –Ω–∞ –∫–∞–∂–¥—É—é —Ä—É–∫—É
        "–æ—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö":     0,    # —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å
        "—Ä–∞–∑–≤–æ–¥–∫–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞":   10,
        "–∫—Ä–æ—Å—Å–æ–≤–µ—Ä":                15,   # –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—É
        "–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è":             0,
        "—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞":      40,
        "—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ":    50,
        "—Ç—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –∫ –ø–æ—è—Å—É":     20,   # –æ–¥–Ω–∞ —Ä—É–∫–∞
        "–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π":    60,
        "–∂–∏–º –Ω–æ–≥–∞–º–∏":               100,
        "—Ä—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞":           50,
        "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥":           30,
        "—Å–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥":             30,
        "–≤—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏":       12,   # –Ω–∞ —Ä—É–∫—É
        "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è":        14,
        "–º–∞—Ö–∏ –≥–∞–Ω—Ç–µ–ª—è–º–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã": 6,
        "—Å–≥–∏–±–∞–Ω–∏—è —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è":     25,
        "–º–æ–ª–æ—Ç–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏":      10,
        "—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º":          20,
        "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ":      25,
        "—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è":              0,
        "–ø–ª–∞–Ω–∫–∞":                   0,
    },
    "–∂": {  # –∂–µ–Ω—â–∏–Ω—ã ‚Äî –ø—Ä–∏–º–µ—Ä–Ω–æ 50‚Äì65% –æ—Ç –º—É–∂—Å–∫–∏—Ö
        "–∂–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞":          30,
        "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞":        10,
        "–æ—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö":     0,
        "—Ä–∞–∑–≤–æ–¥–∫–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞":   6,
        "–∫—Ä–æ—Å—Å–æ–≤–µ—Ä":                10,
        "–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è":             0,
        "—Ç—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞":      25,
        "—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ":    30,
        "—Ç—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –∫ –ø–æ—è—Å—É":     12,
        "–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π":    40,
        "–∂–∏–º –Ω–æ–≥–∞–º–∏":               70,
        "—Ä—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞":           35,
        "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥":           20,
        "—Å–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥":             20,
        "–≤—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏":       8,
        "–∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è":        8,
        "–º–∞—Ö–∏ –≥–∞–Ω—Ç–µ–ª—è–º–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã": 4,
        "—Å–≥–∏–±–∞–Ω–∏—è —à—Ç–∞–Ω–≥–∏ —Å—Ç–æ—è":     15,
        "–º–æ–ª–æ—Ç–∫–∏ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏":      6,
        "—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º":          12,
        "—Ä–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ":      15,
        "—Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è":              0,
        "–ø–ª–∞–Ω–∫–∞":                   0,
    }
}

# –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
WEIGHT_MODIFIERS = {
    "–Ω–æ–≤–∏—á–æ–∫":    0.70,
    "–ª—é–±–∏—Ç–µ–ª—å":   1.00,
    "–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π":1.25,
    "junior":     0.65,   # <18 –ª–µ—Ç
    "middle":     0.90,
    "senior":     0.60,   # ‚â•60 –ª–µ—Ç
}

def get_initial_weight(ex_name: str, –ø–æ–ª: str, —É—Ä–æ–≤–µ–Ω—å: str, –≤–æ–∑—Ä–∞—Å—Ç: int, —Ç—Ä–∞–≤–º—ã: bool) -> int | float:
    base = INITIAL_WEIGHTS_KG.get(–ø–æ–ª, INITIAL_WEIGHTS_KG["–º"]).get(ex_name, 0)
    if base == 0:
        return 0  # —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å –∏–ª–∏ —Ç–µ–ª–æ

    mod = WEIGHT_MODIFIERS.get(—É—Ä–æ–≤–µ–Ω—å, 1.0)
    age_group = get_age_group(–≤–æ–∑—Ä–∞—Å—Ç)
    mod *= WEIGHT_MODIFIERS.get(age_group, 1.0)

    if —Ç—Ä–∞–≤–º—ã:
        mod *= 0.65

    # –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ 2.5 –∫–≥ (—Ç–∏–ø–∏—á–Ω—ã–π —à–∞–≥ –±–ª–∏–Ω–æ–≤ / –≥–∞–Ω—Ç–µ–ª–µ–π)
    weight = round(base * mod / 2.5) * 2.5
    return max(2.5, weight) if weight > 0 else 0


# ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========

def get_valid_variations(main, variations):
    main_key = main.split()[0]

    for key in VALID_VARIATIONS:
        if key in main_key:
            return [
                v for v in variations
                if any(valid in v for valid in VALID_VARIATIONS[key])
            ][:2]

    return variations[:2]


def get_age_group(age: int) -> str:
    """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç–Ω—É—é –≥—Ä—É–ø–ø—É"""
    if age < 18:
        return "junior"
    elif age < 40:
        return "adult"
    elif age < 60:
        return "middle"
    else:
        return "senior"

def is_safe_for_injury(exercise_name: str, —Ç—Ä–∞–≤–º—ã: bool) -> bool:
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –±–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –ø—Ä–∏ —Ç—Ä–∞–≤–º–∞—Ö"""
    if not —Ç—Ä–∞–≤–º—ã:
        return True
    
    # –°–ø–∏—Å–æ–∫ –æ–ø–∞—Å–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –ø—Ä–∏ —Ç—Ä–∞–≤–º–∞—Ö
    dangerous = [
        "–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π",
        "—Ä—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞",
        "–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è",
        "–æ—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö",
        "—Ç—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ"
    ]
    
    # –ï—Å–ª–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –æ–ø–∞—Å–Ω–æ–µ, –∞ —É —á–µ–ª–æ–≤–µ–∫–∞ —Ç—Ä–∞–≤–º—ã ‚Äî –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º
    if exercise_name in dangerous:
        return False
    
    return True

def pick_structured_exercises(muscle: str, —Ç—Ä–∞–≤–º—ã: bool, age: int):
    """–ü–æ–¥–±–∏—Ä–∞–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Å —É—á—ë—Ç–æ–º –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ —Ç—Ä–∞–≤–º"""
    base, secondary, isolation = [], [], []
    
    age_group = get_age_group(age)
    
    for ex_type in EXERCISES.get(muscle, {}):
        for ex in EXERCISES[muscle][ex_type]:
            role = EXERCISE_ROLE.get(ex["name"], "isolation")
            
            # –§–∏–ª—å—Ç—Ä—É–µ–º –æ–ø–∞—Å–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø—Ä–∏ —Ç—Ä–∞–≤–º–∞—Ö
            if not is_safe_for_injury(ex["name"], —Ç—Ä–∞–≤–º—ã):
                continue
                
            # –î–ª—è –ø–æ–∂–∏–ª—ã—Ö –ª—é–¥–µ–π —É–±–∏—Ä–∞–µ–º —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
            if age_group == "senior" and ex["name"] in ["–ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è", "–æ—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö", "–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π"]:
                continue
            
            if role == "base":
                base.append(ex)
            elif role == "secondary":
                secondary.append(ex)
            else:
                isolation.append(ex)

    chosen = []
    
    # –ë–∞–ª–∞–Ω—Å: –≤—Å–µ–≥–¥–∞ —Å—Ç–∞—Ä–∞–µ–º—Å—è –¥–∞—Ç—å —Ö–æ—Ç—è –±—ã 2 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ
    if —Ç—Ä–∞–≤–º—ã or age_group == "senior":
        # –î–ª—è —Ç—Ä–∞–≤–º –∏ –ø–æ–∂–∏–ª—ã—Ö: –±–æ–ª—å—à–µ –∏–∑–æ–ª—è—Ü–∏–∏, –º–µ–Ω—å—à–µ –±–∞–∑—ã
        if secondary and random.random() > 0.3:
            chosen.append(random.choice(secondary))
        if isolation:
            chosen.append(random.choice(isolation))
    else:
        # –î–ª—è –∑–¥–æ—Ä–æ–≤—ã—Ö: –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø–∏—Ä–∞–º–∏–¥–∞
        if base:
            chosen.append(random.choice(base))
        if secondary:
            chosen.append(random.choice(secondary))
        if isolation:
            chosen.append(random.choice(isolation))
    
    # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
    seen = set()
    unique_chosen = []
    for ex in chosen:
        if ex["name"] not in seen:
            seen.add(ex["name"])
            unique_chosen.append(ex)
    
    return unique_chosen

def adjust_by_level(exercises, level, —Ç—Ä–∞–≤–º—ã, age):
    if —Ç—Ä–∞–≤–º—ã or get_age_group(age) == "senior":
        return exercises[:random.choice([1,2])]

    if level == "–Ω–æ–≤–∏—á–æ–∫":
        return exercises[:random.choice([1,2])]

    elif level == "–ª—é–±–∏—Ç–µ–ª—å":
        return exercises[:random.choice([2,3])]

    return exercises[:random.choice([2,3])]

def get_sets_count(level, —Ç—Ä–∞–≤–º—ã, age):
    """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—Ö–æ–¥–æ–≤"""
    if —Ç—Ä–∞–≤–º—ã or get_age_group(age) == "senior":
        return 3
    return 3 if level != "–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π" else 4

def get_reps_range(goal, age):
    base = {
        "–°–∂–µ—á—å –∂–∏—Ä": ["12-15", "15-20"],
        "–°–∫–∏–Ω—É—Ç—å –≤–µ—Å": ["12-15", "15-20"],
        "–ù–∞–±—Ä–∞—Ç—å –º—ã—à—Ü—ã": ["6-10", "8-12"]
    }.get(goal, ["8-12"])

    if get_age_group(age) == "senior":
        return "15-20"

    return random.choice(base)

def get_rest(level, —Ç—Ä–∞–≤–º—ã, age):
    """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—Ä–µ–º—è –æ—Ç–¥—ã—Ö–∞"""
    base_rest = {
        "–Ω–æ–≤–∏—á–æ–∫": "2 –º–∏–Ω",
        "–ª—é–±–∏—Ç–µ–ª—å": "1.5 –º–∏–Ω",
        "–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π": "1 –º–∏–Ω"
    }.get(level, "1.5 –º–∏–Ω")
    
    if get_age_group(age) == "senior":
        return "2 –º–∏–Ω"
    
    return base_rest

# ========== –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø ==========

def generate_workout(user_input: Dict) -> Dict:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """
    —Ü–µ–ª—å = user_input.get("—Ü–µ–ª—å", "–ù–∞–±—Ä–∞—Ç—å –º—ã—à—Ü—ã")
    —É—Ä–æ–≤–µ–Ω—å = user_input.get("—É—Ä–æ–≤–µ–Ω—å_–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏", "–Ω–æ–≤–∏—á–æ–∫")
    —Ç—Ä–∞–≤–º—ã = user_input.get("—Ç—Ä–∞–≤–º—ã_–∏–ª–∏_–±–æ–ª–µ–∑–Ω–∏", "–Ω–µ—Ç") == "–¥–∞"
    –≤–æ–∑—Ä–∞—Å—Ç = user_input.get("–≤–æ–∑—Ä–∞—Å—Ç", 30)


    –¥–Ω–∏ = user_input.get("–¥–Ω–∏_—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫", [])
    –∫–æ–ª_–¥–Ω–µ–π = max(2, min(4, len(–¥–Ω–∏))) if isinstance(–¥–Ω–∏, list) else –¥–Ω–∏

    —Å–ø–ª–∏—Ç = SPLITS_BY_DAYS.get(–∫–æ–ª_–¥–Ω–µ–π, SPLITS_BY_DAYS[3])

    –ø–ª–∞–Ω = {}

    for day_name, muscle_groups in —Å–ø–ª–∏—Ç.items():
        day_plan = []

        for muscle in muscle_groups:
            exercises = []

            structured = pick_structured_exercises(muscle, —Ç—Ä–∞–≤–º—ã, –≤–æ–∑—Ä–∞—Å—Ç)

            for ex in structured:
                exercises.append({
                    "–æ—Å–Ω–æ–≤–Ω–æ–µ": ex["name"],
                    "–≤–∞—Ä–∏–∞—Ü–∏–∏": get_valid_variations(ex["name"], ex["–≤–∞—Ä–∏–∞—Ü–∏–∏"])
                })

            exercises = adjust_by_level(exercises, —É—Ä–æ–≤–µ–Ω—å, —Ç—Ä–∞–≤–º—ã, –≤–æ–∑—Ä–∞—Å—Ç)

            day_plan.append({
                "–≥—Ä—É–ø–ø–∞": muscle,
                "—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è": exercises,
                "–ø–æ–¥—Ö–æ–¥—ã": get_sets_count(—É—Ä–æ–≤–µ–Ω—å, —Ç—Ä–∞–≤–º—ã, –≤–æ–∑—Ä–∞—Å—Ç),
                "–ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è": get_reps_range(—Ü–µ–ª—å, –≤–æ–∑—Ä–∞—Å—Ç),
                "–æ—Ç–¥—ã—Ö": get_rest(—É—Ä–æ–≤–µ–Ω—å, —Ç—Ä–∞–≤–º—ã, –≤–æ–∑—Ä–∞—Å—Ç)
            })

        –ø–ª–∞–Ω[day_name] = day_plan

    # ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ—Å–æ–≤ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–≥–æ –ø–ª–∞–Ω–∞
    –Ω–∞—á–∞–ª—å–Ω—ã–µ_–≤–µ—Å–∞ = {}

    for groups in –ø–ª–∞–Ω.values():
        for group in groups:
            for ex in group["—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è"]:
                –æ—Å–Ω–æ–≤–Ω–æ–µ = ex["–æ—Å–Ω–æ–≤–Ω–æ–µ"]
                –≤–µ—Å = get_initial_weight(
                    ex_name=–æ—Å–Ω–æ–≤–Ω–æ–µ,
                    –ø–æ–ª=user_input.get("–ø–æ–ª", "–º"),
                    —É—Ä–æ–≤–µ–Ω—å=—É—Ä–æ–≤–µ–Ω—å,
                    –≤–æ–∑—Ä–∞—Å—Ç=–≤–æ–∑—Ä–∞—Å—Ç,
                    —Ç—Ä–∞–≤–º—ã=—Ç—Ä–∞–≤–º—ã
                )
                –Ω–∞—á–∞–ª—å–Ω—ã–µ_–≤–µ—Å–∞[–æ—Å–Ω–æ–≤–Ω–æ–µ] = –≤–µ—Å

    return {
        "–ø–ª–∞–Ω_—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫": –ø–ª–∞–Ω,
        "–Ω–∞—á–∞–ª—å–Ω—ã–µ_–≤–µ—Å–∞": –Ω–∞—á–∞–ª—å–Ω—ã–µ_–≤–µ—Å–∞
    }


# ========== –ì–ï–ù–ï–†–ê–¶–ò–Ø ==========

if __name__ == "__main__":
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–æ—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    with open("ai/generateData/users.json", "r", encoding="utf-8") as file:
        users = json.load(file)

    results = []

    for user in users:
        workout = generate_workout(user)
        
        results.append({
            "user": user,
            "workout": workout
        })

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    with open("generated_workouts.json", "w", encoding="utf-8") as file:
        json.dump(results, file, indent=2, ensure_ascii=False)

    print(f"‚úÖ –ì–æ—Ç–æ–≤–æ! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ {len(results)} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
    print(f"üíæ –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ generated_workouts.json")